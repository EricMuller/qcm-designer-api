---
spring:
  profiles: heroku-postgresql
  jpa:
    # open-in-view: false
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    #database: default
    generate-ddl: false
    show-sql: false

    hibernate:
      use-new-id-generator-mappings: true
      ddl-auto: update
      # dll-auto: none
      # ddl-auto: create-drop
      dialect: org.hibernate.dialect.PostgreSQL9Dialect
      properties:
        hibernate:
          enable_lazy_load_no_trans: false
          order_inserts: true
          order_updates: true
          jdbc:
            fetch_size: 100
            batch_size: 20
            batch_versioned_data: true


    properties:
      javax:
        persistence:
          sharedCache:
            mode: ENABLE_SELECTIVE

      hibernate:
        generate_statistics: false
        current_session_context_class: org.springframework.orm.hibernate5.SpringSessionContext
        hikari:
          maximumPoolSize: 30
        cache:
          #required - turn on L2 cache.
          use_second_level_cache: true
          #optional - turn on query cache.
          use_query_cache: true
          region:
            #required - classpath to cache region factory.
            factory_class:  org.hibernate.cache.jcache.JCacheRegionFactory

        javax:
          cache:
            provider: org.ehcache.jsr107.EhcacheCachingProvider
            uri: classpath:ehcache.xml

  cache:
    jcache:
      config: classpath:ehcache.xml

  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    url: ${DATABASE_URL}
    driverClassName: org.postgresql.Driver
    #        username: ${JDBC_DATABASE_USERNAME}
    #        password: ${JDBC_DATABASE_PASSWORD}
    hikari:
      url: ${JDBC_DATABASE_URL}
      pool-name: qcm-hikari-pool
      autoCommit: false
      connection-test-query: SELECT 1
      idleTimeout: 20000
      minimum-idle: 1
      maximumPoolSize: 5
